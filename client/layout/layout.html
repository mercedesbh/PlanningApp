<template name="layout">

	{{#if currentUser}}

	<div class="css-layout-body">

		<div class="css-nav row">
			<div class="css-more col-sm-4">
				<!-- <a href="#"><span class="js-more-btn glyphicon glyphicon-th" onclick="sidenavSlide()"></span></a> -->
			</div>
			<div class="css-logo col-sm-4">
				<a href="{{pathFor 'upcoming'}}">PlanningApp</a>
			</div>
			<div class="css-live-user col-sm-4">

				<a class="css-notify" href="#">[N]</a>

				<div role="presentation" class="dropdown">
					<a class="css-username dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"> {{userName.profile.first}} {{userName.profile.last}} <span class="caret"></span> </a>
					<ul class="dropdown-menu">
						<li><a href="{{pathFor 'events'}}">Events</a></li>
						<li><a href="{{pathFor 'upcoming'}}">Upcoming</a></li>
						<li><a href="#">Calendar</a></li>
						<li role="separator" class="divider"></li>
						<li><a href="{{pathFor 'settings'}}">Settings</a></li>
						<li role="separator" class="divider"></li>
						<li class="js-logout"><a href="#">Logout</a></li>
					</ul>
				</div>

			</div>
		</div>


		<div class="css-side-nav">

			<ul class="css-stacked-nav nav nav-pills nav-stacked">
				<a class="js-modal" data-toggle="modal" data-target=".bd-example-modal-lg" href="#">
					<li>
						<span class="glyphicon glyphicon-plus"></span>
						<p>New Entry</p>
					</li>
				</a>
				<a href="{{pathFor 'upcoming'}}">
					<li class="css-sidenav-upcoming {{highlightUpcoming}}">
						<span class="glyphicon glyphicon-th-list"></span>
						<p> Upcoming </p>
					</li>
				</a>
				<a href="{{pathFor 'events'}}">
					<li class="css-sidenav-events {{highlightEvents}}">
						<span class="glyphicon glyphicon-th-large"></span>
						<p> Events </p>
					</li>
				</a>
				<a href="#">
					<li class="css-sidenav-calendar {{highlightCalendar}}">
						<span class="glyphicon glyphicon-calendar"></span>
						<p>Calendar</p>
					</li>
				</a>
				<a href="#">
					<li class="css-sidenav-search {{highlightSearch}}">
						<span class="glyphicon glyphicon-search"></span>
						<p>Search</p>
					</li>
				</a>
			</ul>

		</div>
		<div class="css-container-fluid">
			<!-- where other templates will be rendered -->
			{{> yield}} {{> modal}}
			<!-- end -->
		</div>


	</div>


	{{else}}

	<div class="css-nav row">
		<div class="css-more col-sm-4"></div>
		<div class="css-logo col-sm-4">
			<a href="{{pathFor 'home'}}">PlanningApp</a>
		</div>
		<div class="css-login-link col-sm-4">
			<a href="{{pathFor 'login'}}">Login</a>
		</div>
	</div>

	<!-- where other templates will be rendered -->
	{{> yield}}
	<!-- end -->

	{{/if}}

</template>

<template name="modal">
	<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">

					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>

					<h3 class="modal-title" id="myModalLabel">
						<div class="css-select-container dropdown pull-left">
							<div role="presentation">
								<select class="css-modal-select js-modal-select form-control">
									<option value="task"><a href="#">Task</a></option>
									<option value="goal"><a href="#">Goal</a></option>
									<option value="text"><a href="#">Text</a></option>
								</select>
							</div>
						</div>
					</h3>
				</div>

				<!-- task view -->
				{{# if taskChosen}}
				<form class="js-new-task" action="layout.html" method="post">
					<br>
					<input class="js-task-title form-control" type="text" placeholder="Title">
					<br>
					<div class="container">
						<div class="row">
							<div class='col-sm-6'>
								<div class="form-group">
									<div class='input-group date' id='datetimepicker5'>
										<input type='text' class="js-task-date form-control" placeholder="Date & Time"/>
										<span class="input-group-addon">
											<span class="glyphicon glyphicon-calendar"></span>
										</span>
									</div>
								</div>
							</div>
							<script type="text/javascript">
								$(function() {
									$('#datetimepicker5').datetimepicker({
										minDate: new Date()
									});
								});
							</script>
						</div>
					</div>
					<br>
					<input class="js-task-location form-control" type="text" placeholder="Location">
					<br>
					{{# if map}}
					<div class="js-task-map">
						<head>
							<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
							<meta charset="utf-8">
							<style>
								html, body {
									height: 100%;
									margin: 0;
									padding: 0;
								}
								#map {
									height: 100%;
								}
							</style>
						</head>
						<body>
							<div id="map" style="width:810px;height:400px;"></div>
							<div id="capture"></div>
							<script>

								// Note: This example requires that you consent to location sharing when
								// prompted by your browser. If you see the error "The Geolocation service
								// failed.", it means you probably did not give permission for the browser to
								// locate you.

								function initMap() {
									var latlng = new google.maps.LatLng(42.358970, -71.066093);
									var myOptions = {
									    zoom: 10,
									    center: latlng,
									    mapTypeId: google.maps.MapTypeId.ROADMAP
									};
									map = new google.maps.Map(document.getElementById("map"), myOptions);
									// var map = new google.maps.Map(document.getElementById('map'), {
									// 	center: {lat: 42.3601, lng: -71.0589},
									// 	zoom: 3
									// });
									var infoWindow = new google.maps.InfoWindow({map: map});

									// Try HTML5 geolocation.
									if (navigator.geolocation) {
										navigator.geolocation.getCurrentPosition(function(position) {
											var pos = {
												lat: position.coords.latitude,
												lng: position.coords.longitude
											};

											infoWindow.setPosition(pos);
											infoWindow.setContent('Location found.');
											map.setCenter(pos);
										}, function() {
											handleLocationError(true, infoWindow, map.getCenter());
										});
									} else {
										// Browser doesn't support Geolocation
										handleLocationError(false, infoWindow, map.getCenter());
									}
								}

								function handleLocationError(browserHasGeolocation, infoWindow, pos) {
									infoWindow.setPosition(pos);
									infoWindow.setContent(browserHasGeolocation ?
																				'Error: The Geolocation service failed.' :
																				'Error: Your browser doesn\'t support geolocation.');
								}
							</script>
							<script async defer
							src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjJkcSNWBO1LHLusupVT4bSMXUgwV1w3M&callback=initMap">
							</script>
						</body>
					</div>
					{{/if}}
					<br>
					<span><input class="js-task-goal" type="radio" value="other"> Check to make it a part of a Goal.</span>
					<br>
					<br>
					<textarea class="js-task-note form-control" placeholder="Add note..."></textarea>
					<br>
				</form>
				{{/if}}

				<!-- goals view -->
				{{# if goalChosen}}
				<form class="js-new-goal" action="layout.html" method="post">
					<br>
					<input class="js-goal-title form-control" type="text" placeholder="Title">
					<br>

					<!-- start goal by... -->
					<div class="container">
						<div class="row">
							<div class='col-sm-6'>
								<h5>Start by:</h5>
								<div class="form-group">
									<div class='input-group date' id='datetimepicker5'>
										<input type='text' class="js-goal-date-s form-control" placeholder="Date & Time"/>
										<span class="input-group-addon">
											<span class="glyphicon glyphicon-calendar"></span>
										</span>
									</div>
								</div>
							</div>
							<script type="text/javascript">
								$(function() {
									$('#datetimepicker5').datetimepicker({
										minDate: new Date()
									});
								});
							</script>
						</div>
					</div>

					<!-- finish goal by... -->
					<div class="container">
						<div class="row">
							<div class='col-sm-6'>
								<h5>Finish by:</h5>
								<div class="form-group">
									<div class='input-group date' id='datetimepicker6'>
										<input type='text' class="js-goal-date-f form-control" placeholder="Date & Time"/>
										<span class="input-group-addon">
											<span class="glyphicon glyphicon-calendar"></span>
										</span>
									</div>
								</div>
							</div>
							<script type="text/javascript">
								$(function() {
									$('#datetimepicker6').datetimepicker({
										minDate: new Date()
									});
								});
							</script>
						</div>
					</div>

					<br>
					<input class="js-goal-location form-control" type="text" placeholder="Location">
					<br>
					<textarea class="js-goal-note form-control" style="height: 150px" placeholder="Add note..."></textarea>
					<br>
				</form>
				{{/if}}

				<!-- text view -->
				{{# if textChosen}}
				<form class="js-new-text" action="index.html" method="post">
					<br>
					<input class="js-text-title form-control" type="text" placeholder="Title">
					<br>
					<textarea class="js-text-text form-control" style="height: 300px" placeholder="Write text..."></textarea>
					<br>
				</form>
				{{/if}}


					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
						<button type="button" class="js-add-entry btn btn-primary">Add to schedule</button>
					</div>

			</div>
		</div>
	</div>

</template>
